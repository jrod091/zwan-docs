#!/bin/bash
#
# See LICENSE for copyright information
#

arp()
{
cat <<EOF
{
 /* Dst Mac */
 ${1:-0xff,0xff,0xff,0xff,0xff,0xff,}
 /* Src Mac */
 ${2:-0x11,0x22,0x33,0x440,0x55,0x66,}
 /* EtherType */
 c16(0x0806),

 /* ARP RFC 896 */

 	/* Hardware Type - Ethernet */
	0x00,0x01,
	/* Protocol Type - IP */
	0x08,0x00,
	/* Hardware Size */
	6,
	/* Protocol Size */
	4,
	/* Opcode */
	$OPCODE
	/* Sender MAC Address */
 	${2:-0x11,0x22,0x33,0x440,0x55,0x66,}
	/* Sender IP Address */
 	${3:-192,168,1,254,}
	/* Target MAC Address */
	${1:-0xff,0xff,0xff,0xff,0xff,0xff,}
	/* Target IP Address */
 	${4:-192,168,1,1,}

 /* Ethernet Padding (Must be 64 bytes) */
 0x00,0x00,0x00,0x00,0x00,0x00,
 0x4b,0xd00,0x00,0x00,0x4b,0xd0,
 0x00,0x00,0x00,0x50,0x00,0x01,
}
EOF
}

